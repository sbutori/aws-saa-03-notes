# Networking Start Pack

## OSI 7-Layer Model
The OSI (Open Systems Interconnection) model is a framework that describes the functions and interactions of computer systems in a network.

- Local Networking: Ethernet (start / end point of data moving across internet)
- Routing: Moving data across multiple networks
- Segmenting, Ports, and Sessions
- Applications

1. Physical
2. Data Link
3. Network
4. Transport
5. Session
6. Presentation
7. Application
^ These 7 layers are the "Networking Stack". 1-3 are Media Layers, 4-7 are Host Layers

### Layer 1 - Physical
Imagine you have two laptops at home and you want to LAN game between the two. You have a physical connection/medium between the two laptops (network interface card, network cable).

Physical Medium: can be Copper (electrical), fiber (light), of WiFi (RF). 

A Layer 3 device has the capabilities of all layers under it (3, 2, and 1). A Layer 1 device only has the capabilities of Layer 1, as no layers are below it.

There are no individual device addresses at Layer 1. Anything received on any port is transmitted out on every other port (including errors and collisions). If multiple devices transmit on the same level 1 physical medium, a collision occurs and corrupts data. The more layer 1 devices connected, the more likely a collision.

Layer 1 is "dumb". 1 broadcast and 1 collision domain, not very scalable. No access control. No uniquely identifiable devices. so no device-to-device communication.

### Layer 2 - Data Link (DL)
Data Link adds lots of intelligence to layer 1, allowing for more effective communication. DL all higher layers rely on Layer 2 as it supports the transfer of data.

Rather than physical wavelengths or voltages, but uses "frames". Devices at L2 have a unique hardware (MAC) address. Frames can be addressed to a destination or to a broadcast.

Frame is a container of sorts.
- First is PREAMBLE (let's device know this is start of the frame
- Destination and Source MAC addresses
- EtherType: which layer 3 protocol is putting its data in a frame
- Payload: The data the frame carries from source to destination
- Frame Check Sequence (FCS): Confirm it corruption has occurred

Mac Header = Source MAC address + Destination MAC address + EtherType

In order to have active Layer 2 network, you need Layer 1 active and working. Layer 2 checks for carriers, if no carriers, Frame is sent to Layer 1 for transmission. Carrier detected? Wait, as another device is transmitting.

CSMA: Carrier Sense Multiple Access. Detects data to avoid collision.

Encapsulation: When data is wrapped in by a Frame. As data is passed down OSI model, many different components encapsulate the data.

Collision Detection at layer 2. If both devices check for carrier which doesn't exist, then both L2's instruct transmission via layer 1, a collision can occur. If collision is detected, jam signal is sent and a random backoff occurs. Backoff = time + random. It increases if another collision occurs.

Hub = layer 1 device. Dumb, send data to all ports.
Switch = layer 2 device. Maintains MAC address table to learn what's connected to each port. Intelligent; store and forward Frames appropriately, based on MAC address table. Won't forward collisions. Each port becomes a separate collision domain.

- Identifiable devices
- Media Access Control (sharing)
- Collision Detection
- Unicast 1:1
- Broadcast 1:ALL
- Switches

### Layer 3 - Network
Requires 1 or more Layer 2 networks to function. Layer 3 gets data from one location to another. With streaming, data moved from server hosting video to local device.

#### Why is Layer 3 needed?
If we have two local area networks with geographic separation (east/west coast US separation). LAN1 and LAN2 are isolated Layer 2 local networks right now. You *could* use point to point physical links across the distance, but this is costly. Layer 2 protocols can be different so connecting to L2 networks can be challenging. We need something in common between the two L2's. To move data between two local networks... inter-networking ==> internet. IP addresses can be assigned as a way to connect separated L2 networks.

- Routers are the hardware that L3 uses to encapsulate data in an IP packet.

- IP allows you to connect to remote networks, allowing you to cross over intermediary networks in between.

Packet: Data unit used in IP. Similar to Frames (L2). Every packet has a Source IP and Destination IP address.

- Two versions of IP in use. Version 4 and Version 6.
-- Destination/Source IP addresses are larger in v6 to allow for more.

#### L3: IP Addressing (IPv4)
Structure of an IP address. This section focuses on v4.

IP Address
133 . 33 . 3 . 7
- Dotted decimal notation from 0 - 255
- All IP addresses formed of two different partsL 1) Network (133.33), 2) Hosts (3.7)
- You can see if two IP addresses are on same network if the first half matches (both being 133.33)
- 4 sets of 8 bits, 32 bits total for IP address. Each number in IP Address is an octet
- /16 prefix. First 16 bits are network, last 16 bits are host
- Static IP: assigned by humans. DHCP: Machine assigned IPs
- IP addresses need to be unique, esp on local network

Subnet Masks: ID's host and network parts of IP addresses. So it can know when to send data on same local network, or use a router to transport across different networks. Configured on L3 along with IP addresses. Allows an IP device to know if IP is on same network or not. If not on same network, data is sent to Default Gateway (router)
- e.g. 255.255.0.0 is a subnet mask, and is the same as the /16 prefix (when broken down into binary)

#### L3: Route Tables & Routes
How a router decides where to send data.

Every router has at least 1 route table. This is how a router knows where to send data. Two fields: 1) destination field 2) Next Hop/Target. The larger the prefix, the more specific the route (/0, /16, /32). Routers prefer more specific routes.  

/24 = first 24 bits for network, last 8 bits are for host.

Default Route: 0.0.0.0/0 = matches if nothing else does.

IMPORTANT: When ISP router is forwarding packet to AWS router, it's forwarding it at Level 2; wrapped in a Frame. How do we determine MAC address of AWS router? Address Resolution Protocol

#### L3: Address Resolution Protocol
Used when Layer 3 packet needs to be encapsulated in a Frame and sent to MAC address. You don't know the MAC address, but you need to get it. This is where ARP comes in. 
- ARP will give you MAC address with given IP address
- ARP broadcasts on Layer 2

#### L3: IP Routing
Lengthy example, not a very great visual. Recommend looking up another video on YouTube for IP Routing Explanation

### Layer 4 & 5 - Transport & Session
Layer 4 allows you to create Segments with a sequence number in order to maintain the order (L3 can't control order of packets)


NOTE: Course is no longer broken down by Layers


#### TCP - Transmission Control Protocol
- connection between client and server used to exchange data
- established between two devices using a 'random port' on a client and a 'known port' on the server
- connection is reliable provided via segments encapsulated in IP packets. Orders segments with their sequence numbers
- also has error checking and retransmission
- bidirectional connections
- creates a 'channel' to exchange data, but really it's just a collection of segments; no real channel
- Ephemeral Port: client source port (or High Ports). Needs separate rules compared to Well Known Port
- Well Known Port: server port. Needs separate rules compared to Ephemeral Port

##### Flags Field in TCP
Contains actual flags which can be set to influence the connection.
FIN - used to close
ACK - used for acknowledgments
SYN - sequence numbers
1) "Hey, let's talk": Send segment to server with SYN (initial sequence number is ISN, or 'cs'; sequence set)
2) "Sure, let's talk": SYN-ACK - server receives communication from client, receives cs, sets ACK to cs+1, sends cs+1 and ss
3) "Awesome, go!": Send segment with ACK, send to ss+1
4) Connection established, client can send data

##### Firewalls on Ephemeral Port side
- Stateless Firewall: Doesn't understand state of a connection. Two rules 1) OUT: allow outbound segments (initiating traffic) 2) IN: allow response (response traffic). In AWS, a Nework Access Control List (ACL) is a stateless firewall.
- Stateful Firewall: Sees OUT and IN as the same thing; if OUT allowed, IN is auto-alowed (and vice versa). In AWS, this is how a Security Group works

### Network Address Translation (NAT)
We will cover the basics of NAT, including how it works, its different types, and the benefits and drawbacks of using NAT.
- NAT is a process designed to address growing shortages of IPv4 addresses
- Translates Private IPv4 addresses to Public and back as they cannot communicate otherwise. This is what gets Private IPs on the internet
-- Publically routable addresses (must be unique)
-- Private addresses (don't need to be unique, can be used multiple places)
- Router is an example of a NAT device

#### Types of NATs (3)
1 - Static NAT: 1 private to 1 (fixed) public address (IGW, Internet Gateway). Gives private address access to internet in both directions
2 - Dynamic NAT: Pool of public IP addresses for private IP's to use. Generally used with large number of private IP addresses but have less Public Addresses than private. Private IPs must use the Public IP allocations at DIFFERENT times; they cannot overlap. External access may fail if there are no IPs in the public pool
3 - Port Address Translation (PAT): Many private to 1 public (AWS NATGW). This is what your home router does with multiple devices. Uses ports to ID devices
-- This is the method that NAT instances use in AWS NATGateway (NATGW)
-- Uses both IP addresses &  Ports to allow multiple devices to use same IP
-- MANY:1, PrivateIP:PublicIP Architecture

- NAT only makes sense for IPv4. IPv6 has enough addresses, as is (no need for NAT in IPv6)

### IP Address Space & Subnetting (IPv4)
Originally this was directly managed by IANA (Internet Assigned Numbers Authority)
- Parts now delegated to regional authorities
- There are about 4.3B IPv4 addresses

#### Address Space Classing
Class A Address Space: 0.0.0.0 -> 127.255.255.255 (for huge business/early internet)
Class B Address Space: 128.0.0.0 -> 191.255.255.255 (for larger businesses that didn't need Class A)
Class C Address Space: 192.0.0.0 -> 223.255.255.255 (for smaller businesses not large enough for B or A)
Class D & Class E: D for Multicast, E is Reserved

#### Private IP Adresses
Defined by a standard RFC1918

When possible, allocate non-overlapping ranges across your networks.

##### IPv4 Address Space
See Class A - E above. 4,294,967,296 total IPs in IPv4. Too few which is why IPv6 was created (340 trillion trillion trillion addresses)

##### IP Subnetting (IPv4)
Subnetting takes a large network and breaks into smaller networks.

CIDR (Classless Inter-Domain Routing) - Let's us take networks and break them down, determining size of network (ex. /16 prefix)
/8 is the same as a class A network
/16 is smaller network within Class A network
- The larger the prefix value, the smaller the network

If you have a large network, you can subnet them. /16 => 2 * /17, split network in 2. One /16 network is the same as 2 /17 networks.
-- Now we have two /17 networks. We can split one of these into 2 * /18. Now we have 3x: /17, /18. and /18 networks.
--- To get to 4 networks, split the remaining /17 network into another two /18 networks, for four total
-- /32 represents a single IP address
- While unusual, it is possible to have odd numbered split networks

Entire internet is a /0 network. This is why 0.0.0.0 matches the entire internet.

Eg. 10.16.0.0/16 = 10.16.0.0 => 10.16.255.255 -- Start to End of Network
- If you create /17 subnets from this...
-- 10.16.0.0/17 (1) = 10.16.0.0 => 10.16.127.255
-- 10.16.128.0/17 (2) = 10.16.128.255 => 10.16.255.255
- And so on. Think of it as splitting network ranges in half each time.

### DDOS Attacks - Distributed Denial of Service Attacks
A Distributed Denial of Service (DDoS) attack is a type of cyber attack where multiple compromised devices, often from different locations, are used to flood a targeted website or network with traffic, causing the website or network to become unavailable to its users

#### VLAN - Virtual Local Area Networking
Avoids forcing physical networking throughout an organization.

Frame Tagging (802.1Q & 802.1AD) - used for VLAN ID or VID
- 802.1Q allows multiple VLANs over the same L2 physical network
- If two 802.1Q VLANs over different connected networks have the same VLAN, 802.1AD adds new fields to VLAN to make same VLAN #'s unique
- One Switch can host multiple Broadcast Domains
- Trunk Port: Connection between 2 802.1Q capable devices
- Devices on different VLANs cannot communicate without a Layer 3 Device (router)

VLANs allow you to create separate L2 network segments to allow for Isolation
VLANs offer separate broadcast domains
802.1Q == VLANs
802.1AD (nested Q-in-Q VLANs)
Q-in-Q used in larger networks. .1Q for smaller networks.

### Decimal to Binary Conversion (IP Addressing)
In computer networking, IP (Internet Protocol) addresses are used to identify and communicate with devices on a network. IP addresses are typically represented in decimal notation, with four decimal numbers separated by periods (e.g. 192.168.1.1). However, computers process and transmit data in binary form, which is a sequence of 0s and 1s. To enable communication between devices, IP addresses must be converted from decimal to binary form, and vice versa. In this lesson, we will explore how to convert IP addresses from decimal to binary form and from binary to decimal form.
** for IPv4 Addressing

Eg. 133.33.33.7 -> Dotted decimal notation, which is what a human sees
- Computer sees 10000101.00100001.00100001.00000111

#### Decimal to Binary
Eg. 133.33.33.7 to binary. 
HINT: Use binary table https://www.networkacademy.io/ccna/ip-subnetting/converting-ip-addresses-into-binary
- 133, 33, 33, 7 are numbers each between 0 - 255. Tackle these sets of number individually. Each number in IP is 8 bits.
-- 133. If this number is less than Binary Position Value, write a 0. If equal or larger, minus binary position from your decimal number, add 1 in binary column (133 - 128 = 5. 
-- Position two is 5. 5 is less than 64, so write a 0. Position 3-5 are also less than 5. Put 0's
-- Position 6. Remaining value is 5, Binary Position Value is 4. 5 - 4 = 1. Put a 1 in position 6

BINARY VALUE of 133: [ 1 ][ 0 ][ 0 ][ 0 ][ 0 ][ 1 ][ 0 ][ 1 ]
BINARY VALUE of 33: [ 0 ][ 0 ][ 1 ][ 0 ][ 0 ][ 0 ][ 0 ][ 1 ]
BINARY VALUE of 33: [ 0 ][ 0 ][ 1 ][ 0 ][ 0 ][ 0 ][ 0 ][ 1 ]
BINARY VALUE of 7: [ 0 ][ 0 ][ 0 ][ 0 ][ 0 ][ 1 ][ 1 ][ 1 ]

#### Binary to Decimal
Eg. 10000101.00100001.00100001.00000111
- Break into 4 sections. Work left to right. Still using conversion table
1. 10000101. Match digit with corresponding position on table. [128][0][0][0][0][4][0][1] = 133
2. 00100001. [0][0][32][0][0][0][0][1] = 33
3. 00100001. [0][0][32][0][0][0][0][1] = 33
4. 00000111. [0][0][0][0][0][4][2][1] = 7
